<!DOCTYPE html>
<html lang="en" class="vf-no-js" >
<head>
  <script>
  // Detect if JS is on and swap vf-no-js for vf-js on the html element
  (function(H){H.className=H.className.replace(/\bvf-no-js\b/,'vf-js')})(document.documentElement);
  </script>
  <meta charset="utf-8">
  <meta name="viewport" content=
  "width=device-width, initial-scale=1">
  <link rel="stylesheet" media="all" href="https://assets.emblstatic.net/vf/v2.4.5/css/styles.css">
  
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>
    
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
  
  
</head>

<body class="vf-body vf-stack"><script id="__bs_script__">//<![CDATA[
    document.write("<script async src='/browser-sync/browser-sync-client.js?v=2.26.14'><\/script>".replace("HOST", location.hostname));
//]]></script>


<section class="vf-intro" id="an-id-for-anchor">

  <div class="vf-stack">

    <p class="vf-intro__text">ThermoAffinity allows the analysis of experiments where ligand 
    binding changes the signal produced by the (labelled) protein.</p>


<div class="vf-section-header"><a class="vf-section-header__heading vf-section-header__heading--is-link" href="JavaScript:Void(0);" id="section-link" onclick="myFunction('inputFile')">Input file <svg aria-hidden="true" class="vf-section-header__icon | vf-icon vf-icon-arrow--inline-end" width="1em" height="1em" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 12c0 6.627 5.373 12 12 12s12-5.373 12-12S18.627 0 12 0C5.376.008.008 5.376 0 12zm13.707-5.209l4.5 4.5a1 1 0 010 1.414l-4.5 4.5a1 1 0 01-1.414-1.414l2.366-2.367a.25.25 0 00-.177-.424H6a1 1 0 010-2h8.482a.25.25 0 00.177-.427l-2.366-2.368a1 1 0 011.414-1.414z" fill="" fill-rule="nonzero"></path>
    </svg></a></div>
    
<div id="inputFile" style="display:none">
  
    <p class="vf-intro__text">ThermoAffinity accepts as input the spreadsheet generated by NanoTemper Technologies. This file contains one sheet called ‘RawData’ where the first column has different cells with the following labels: ‘Capillary Position:’,  ‘Ligand:’,  ‘Ligand Concentration:’, and ‘Time [s]’. Then, the second column stores the associated information: ‘1’, ‘ligand description’, ‘5000’, and ‘Raw Fluorescence [counts]’. The next capillary information is going to be read from columns 4 and 5, then from columns 7 and 8, etc. <a href="demo.xlsx" download>(demo.xlsx)</a>. If you have many xlsx files, you can load a zip. </p>
   
   
<figure class="vf-figure vf-figure--align vf-figure--align-centered">
<img src="mst_file_example.png" alt="" width="600" loading="lazy"/>
</figure>

<br>

    <p class="vf-intro__text">To export the spreadsheet file from the MO Affinity Analysis Software, you need to click 'Raw Data Inspection', 'Export', 'Export Raw Data'.</p>

<figure class="vf-figure vf-figure--align vf-figure--align-centered">
5<img src="exportMSTdata.png" alt="" width="600" loading="lazy"/>
</figure>

    <p class="vf-intro__text"></p>

       <p class="vf-intro__text"> Additionally, to take advantage of the provided models you can upload a CSV with at least two columns (with or without header): Ligand Concentration & Signal Value. The CSV may have two more columns: Protein Concentration and/or Experiment ID. Download some examples here: 
       <a href="test1.csv" download>test1.csv</a> ,
       <a href="test2.csv" download>test2.csv</a> ,
       <a href="test3.csv" download>test3.csv</a>
       </p>
    
</div>

<div class="vf-section-header"><a class="vf-section-header__heading vf-section-header__heading--is-link" href="JavaScript:Void(0);" id="section-link" onclick="myFunction('models')">Models <svg aria-hidden="true" class="vf-section-header__icon | vf-icon vf-icon-arrow--inline-end" width="1em" height="1em" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 12c0 6.627 5.373 12 12 12s12-5.373 12-12S18.627 0 12 0C5.376.008.008 5.376 0 12zm13.707-5.209l4.5 4.5a1 1 0 010 1.414l-4.5 4.5a1 1 0 01-1.414-1.414l2.366-2.367a.25.25 0 00-.177-.424H6a1 1 0 010-2h8.482a.25.25 0 00.177-.427l-2.366-2.368a1 1 0 011.414-1.414z" fill="" fill-rule="nonzero"></path>
    </svg></a></div>
   
<div id="models" style="display:none"> 

<div class="vf-links">
  <ul class="vf-links__list | vf-list">
    
    <li class="vf-list__item">
      <a class="vf-list__link" onclick="myFunction('modelsOneBindingSite')" href="JavaScript:Void(0);">
       One Binding Site
      </a>
    </li>

  <div id="modelsOneBindingSite" style="display:none">
  
    <p class="vf-intro__text">The selected signal (initial fluorescence or MST trace) is fitted using a simple model where the contribution of the complex and the unbound protein is given by the following equation: </p>

$$
\large{ 
    Signal(K_d,L_0,P_0) = RF1 * P(K_d,L_0,P_0) + RF2 * PL(K_d,L_0,P_0)
   }
$$

    <p class="vf-intro__text">where \( P \) and \( PL \) are respectively the unbound free protein and the bound protein. \( P_{0} \) and \( L_{0} \) are respectively the total protein and ligand concentration and \( K_{d} \) is the dissociation constant linked to the chemical equilibrium </p>
    
    $$
\large{ 
         P + L \rightleftharpoons PL , K_d = \frac{P*L}{PL}
   }
$$

    <p class="vf-intro__text">We can then use the equations from the principle of mass conservation \( P_0 = P + PL \), \( L_0 = L + PL \)  to transform the signal into  </p>
    
    $$
\large{ 
        \frac{RF2 - RF1}{2}*( (K_d+P_0+L_0) - \sqrt{(K_d+P_0+L_0)^2 - 4*P_0*L_0)}) + RF1*P_0
   }
$$


</div>

    <li class="vf-list__item">
      <a class="vf-list__link" onclick="myFunction('modelsTwoBindingSites')" href="JavaScript:Void(0);">
      Two Binding Sites
      </a>
    </li>

  <div id="modelsTwoBindingSites" style="display:none">
    
    <p class="vf-intro__text">In the case of two binding sites, the Signal can be explained by a linear combination of the amount of free unbound protein, *right-bound* complex (PL), *left-bound* complex (LP), and double-bound complex (LPL).</p>

    $$
\large{ 
        Signal(L_0,P_0,K_{d1},K_{d2},cFactor) = RF1*P + RF2*PL + RF3*LP + RF4*LPL
   }
$$


  <p class="vf-intro__text"> where \( RF1 \), \( RF2 \), \( RF3 \), and \( RF4 \) are scalars to fit and  \( L_0 \) , \( P_0 \), \( K_{d1} \), \( K_{d2} \), \( cFactor \) are respectively the total protein concentration, total ligand concentration, the dissociation constant 1, the dissociation constant 2, and cooperativity factor. The associated chemical equilibria are </p>
 
$$
\large{
P +  2L  \rightleftharpoons PL + L
}
$$

$$
\large{
P +  2L  \rightleftharpoons LP + L
}
$$

$$
\large{
PL +  L  \rightleftharpoons LPL 
}
$$

$$
\large{
LP +  L  \rightleftharpoons LPL
}
$$
 
<p class="vf-intro__text">with equations</p>  

$$
\large{
P = \frac{K_{d1}K_{d2}(L_0-L) }{(K_{d1}+K_{d2}+2*L)*L}
}
$$

$$
\large{
    PL  = \frac{L*P}{K_{d2}}
}
$$

$$
\large{
    LP  = \frac{L*P}{K_{d1}} 
}
$$

$$
\large{
   LPL = \frac{LP * L}{K_{d2} * cFactor}
}
$$
 
      <p class="vf-intro__text"> that together with the principle of mass conservation result in the cubic equation</p>  
 

 $$
\large{
       X^3 + bX^2 + cX + d = 0

}
$$

$$
\large{
       b = [ K_{d2} + K_{d1} + (2*P_0-L_0)  / cFactor ] * cFactor

}
$$

$$
\large{
      c = [ (P_0-L_0)*(K_{d1}+K_{d2}) + K_{d1}K_{d2}       ] * cFactor
}
$$

$$
\large{
    d = [-L_0*K_{d1}K_{d2}                        ] * cFactor
}
$$

<p class="vf-intro__text">whose only physical root is the amount of free ligand. And because \( K_{d1} \), \( K_{d2} \), and the \( cFactor \) are supposed to be known during the fitting, we can easily obtain then \( PL \), \( LP \) and \( LPL \). Due to the number of parameters, this model must be simplified. Regarding the parameters \( RF1 \), \( RF2 \), \( RF3 \) and \( RF4 \) we present two alternatives.</p>  

$$
\large{
    A) RF2 = RF3  = RF1 + \Delta F \:  \&  \: RF4 = RF1 + 2 \Delta F
}
$$

$$
\large{
     B) RF1 = RF2             \:  \& \: RF4 = RF3 = RF1 + \Delta F 
}
$$
           
<p class="vf-intro__text">In option A), both binding sites affect equally the signal. In option B), only one binding site is responsible for the change in the signal ( \( K_{d1} \) ). For \( K_{d1} \), \( K_{d2} \) and the cooperativity factor there are three alternatives.</p>   

$$
\large{
    A) K_{d1}  = K_{d2} \: \& \: cFactor = 1
}
$$

$$
\large{
     B) K_{d1}  = K_{d2}  \: \& \: cFactor \neq 1
}
$$

$$
\large{
     C) K_{d1} \neq  K_{d2}  \: \& \: cFactor = 1
}
$$

<p class="vf-intro__text">In option A), there is no cooperativity and \( K_{d1} \) equals \( K_{d2} \). In option B), \( K_{d1} \)  equals \( K_{d2} \) and binding to one site affects binding to the other site. In option C), \( K_{d1} \) is different from \( K_{d2} \) and there is no cooperativity. The combination of these options results in six possible models (See Table below). </p>   
<br>
<table class="vf-table">

  <thead class="vf-table__header">
    <tr class="vf-table__row">
      <th class="vf-table__heading" scope="col"> Model Name
      </th>
      <th class="vf-table__heading" scope="col"> #Parameters
      </th>
      <th class="vf-table__heading" scope="col"> Details
      </th>
    </tr>
  </thead>

  <tbody class="vf-table__body">
    
    <tr class="vf-table__row">
      <td class="vf-table__cell">One Site, One Kd</td>
      <td class="vf-table__cell">3</td>
      <td class="vf-table__cell">The simplest model, different signal for P and PL</td>
    </tr>
    
    <tr class="vf-table__row">
      <td class="vf-table__cell">Two Sites, One Kd, Shared Signal</td>
      <td class="vf-table__cell">3</td>
      <td class="vf-table__cell">Different signal between P, PL(= LP) and LPL</td>
    </tr>

    <tr class="vf-table__row">
      <td class="vf-table__cell">Two Sites, One Kd, Different Signal</td>
      <td class="vf-table__cell">3</td>
      <td class="vf-table__cell">Different signal between P(= PL) and LP(=LPL)</td>
    </tr>

    <tr class="vf-table__row">
      <td class="vf-table__cell">Two Sites, One Kd, Shared Signal, Cooperativity</td>
      <td class="vf-table__cell">4</td>
      <td class="vf-table__cell">Different signal between P, PL(= LP) and LPL, cooperativity factor included in the equations</td>
    </tr>

    <tr class="vf-table__row">
      <td class="vf-table__cell">Two Sites, One Kd, Different Signal, Cooperativity</td>
      <td class="vf-table__cell">4</td>
      <td class="vf-table__cell">Different signal between between P(= PL) and LP(=LPL), cooperativity factor included in the equations</td>
    </tr>
    
    <tr class="vf-table__row">
      <td class="vf-table__cell">Two Sites, Two Kds, Shared Signal</td>
      <td class="vf-table__cell">4</td>
      <td class="vf-table__cell">Different signal between P, PL(= LP) and LPL and Kd1 != Kd2</td>
    </tr>

    <tr class="vf-table__row">
      <td class="vf-table__cell">Two Sites, Two Kds, Different Signal</td>
      <td class="vf-table__cell">4</td>
      <td class="vf-table__cell">Different signal between between P(= PL) and LP(=LPL) and Kd1 != Kd2</td>
    </tr>

  </tbody>
</table>

<br>

<p class="vf-intro__text">In all cases, the units of \( RF1 \) and \( RF2 \) are returned after the fitting in [ 1 / µM].</p> 

</div>
</ul>
</div>
</div>


<div class="vf-section-header"><a class="vf-section-header__heading vf-section-header__heading--is-link" href="JavaScript:Void(0);" id="section-link" onclick="myFunction('SignalFittingSuggestions')">Signal fitting suggestions <svg aria-hidden="true" class="vf-section-header__icon | vf-icon vf-icon-arrow--inline-end" width="1em" height="1em" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 12c0 6.627 5.373 12 12 12s12-5.373 12-12S18.627 0 12 0C5.376.008.008 5.376 0 12zm13.707-5.209l4.5 4.5a1 1 0 010 1.414l-4.5 4.5a1 1 0 01-1.414-1.414l2.366-2.367a.25.25 0 00-.177-.424H6a1 1 0 010-2h8.482a.25.25 0 00.177-.427l-2.366-2.368a1 1 0 011.414-1.414z" fill="" fill-rule="nonzero"></path>
    </svg></a></div>

<div id="SignalFittingSuggestions" style="display:none">
  
    <p class="vf-intro__text">Two Sites, Different Signal: The usage of models where the signal of the \( LP \) complex is different from the \( PL \) complex makes sense only in some specific cases. For example, when we use as a signal the initial fluorescence and only one of the binding sites has a tryptophan nearby that can be quenched.</p>
    
    <p class="vf-intro__text">Two Sites, Two Kds: Unless you consider that the two \( K_ds \) may be significantly different (> 50X), use the model with only one \( K_d \). Also, before performing an MST experiment where you consider you may have to fit two \( K_ds \), use the simulation panel to understand how depending on the conditions (protein concentration, etc.) \( K_{d1} \) and \( K_{d2} \) affect the binding curve.</p>
    
    <p class="vf-intro__text">After fitting: Always verify that each of the fitted parameters is not close to its fitting bounds (Advanced Settings of the Fitting Panel) and that the confidence interval of the estimated \( K_{d} \)  does not extend more than 5-10X from the lower to the upper limit. </p>

</div>

<div class="vf-section-header"><a class="vf-section-header__heading vf-section-header__heading--is-link" href="JavaScript:Void(0);" id="section-link" onclick="myFunction('FittingErros')">Fitting errors and confidence intervals <svg aria-hidden="true" class="vf-section-header__icon | vf-icon vf-icon-arrow--inline-end" width="1em" height="1em" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 12c0 6.627 5.373 12 12 12s12-5.373 12-12S18.627 0 12 0C5.376.008.008 5.376 0 12zm13.707-5.209l4.5 4.5a1 1 0 010 1.414l-4.5 4.5a1 1 0 01-1.414-1.414l2.366-2.367a.25.25 0 00-.177-.424H6a1 1 0 010-2h8.482a.25.25 0 00.177-.427l-2.366-2.368a1 1 0 011.414-1.414z" fill="" fill-rule="nonzero"></path>
    </svg></a></div>

<div id="FittingErros" style="display:none">
  
    <p class="vf-intro__text">The standard deviation of all fitted parameters is computed using the square root of diagonal values from the fit parameter covariance matrix. This error is then used to obtain symmetric 95% t-based confidence intervals (Asymptotic).</p>
    
    <p class="vf-intro__text">When fitting the '1:1' or the '1:2' (one Kd) binding models, we also provide the marginal asymmetric confidence interval. It has been shown that this approach is more robust in estimating uncertainties, so we recommend reporting this result (Vaida Paketuryte, et al, 2021). </p>

</div>

<div class="vf-section-header"><a class="vf-section-header__heading vf-section-header__heading--is-link" href="JavaScript:Void(0);" id="section-link" onclick="myFunction('GeneralSuggestions')">General suggestions <svg aria-hidden="true" class="vf-section-header__icon | vf-icon vf-icon-arrow--inline-end" width="1em" height="1em" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 12c0 6.627 5.373 12 12 12s12-5.373 12-12S18.627 0 12 0C5.376.008.008 5.376 0 12zm13.707-5.209l4.5 4.5a1 1 0 010 1.414l-4.5 4.5a1 1 0 01-1.414-1.414l2.366-2.367a.25.25 0 00-.177-.424H6a1 1 0 010-2h8.482a.25.25 0 00.177-.427l-2.366-2.368a1 1 0 011.414-1.414z" fill="" fill-rule="nonzero"></path>
    </svg></a></div>

<div id="GeneralSuggestions" style="display:none">
  
    <p class="vf-intro__text">1) To obtain a good estimation of the binding affinity, perform several assays and fit each curve independently.</p>
    
    <p class="vf-intro__text">2) The models to fit the MST (or Fluorescence) data are based on binding reactions that have reached equilibrium. Therefore, based on the expected binding affinity analyze if it is important to vary incubation time to test for equilibration:</p>
    
<br>
<table class="vf-table">

  <thead class="vf-table__header">
    <tr class="vf-table__row">
      <th class="vf-table__heading" scope="col"> Kd
      </th>
      <th class="vf-table__heading" scope="col"> Kon
      </th>
      <th class="vf-table__heading" scope="col"> TimeEquilibration
      </th>
    </tr>
  </thead>

  <tbody class="vf-table__body">
    
    <tr class="vf-table__row">
      <td class="vf-table__cell">1 μM</td>
      <td class="vf-table__cell">10^8</td>
      <td class="vf-table__cell">0.04 seconds</td>
    </tr>
    
    <tr class="vf-table__row">
      <td class="vf-table__cell">1 μM</td>
      <td class="vf-table__cell">10^6</td>
      <td class="vf-table__cell">4 seconds</td>
    </tr>

    <tr class="vf-table__row">
      <td class="vf-table__cell">1 μM</td>
      <td class="vf-table__cell">10^3</td>
      <td class="vf-table__cell">60 minutes</td>
    </tr>

    <tr class="vf-table__row">
      <td class="vf-table__cell">1 nM</td>
      <td class="vf-table__cell">10^8</td>
      <td class="vf-table__cell">40 seconds</td>
    </tr>

    <tr class="vf-table__row">
      <td class="vf-table__cell">1 nM</td>
      <td class="vf-table__cell">10^6</td>
      <td class="vf-table__cell">60 minutes</td>
    </tr>
    
    <tr class="vf-table__row">
      <td class="vf-table__cell">1 pM</td>
      <td class="vf-table__cell">10^8</td>
      <td class="vf-table__cell">10 hours</td>
    </tr>

  </tbody>
</table>

<br>

    <p class="vf-intro__text">Values taken from Inga Jarmoskaite et al., 2020 (Table 1). As a reference, the fastest Kon reported in the Binding Database (<a target="_blank" href="https://www.bindingdb.org" download>Binding DB</a>) is (7.06E+9).</p>
    
</div>

</div>
</section>

  <!-- IE11 polyfill JS -->
  <script nomodule crossorigin="anonymous" src="https://polyfill.io/v3/polyfill.min.js?flags=gated&features=default"></script>
  <script src="https://assets.emblstatic.net/vf/v2.4.5/scripts/scripts.js"></script>
  
  <!-- Hide div element onclick JS -->
  <script>
    function myFunction(divID) {
      var x = document.getElementById(divID);
      if (x.style.display === "none") {
        x.style.display = "block";
      } else {
        x.style.display = "none";
      }
    }
  </script>
  

</body>
</html>