<!DOCTYPE html>
<html lang="en" class="vf-no-js" >
<head>
  <script>
  // Detect if JS is on and swap vf-no-js for vf-js on the html element
  (function(H){H.className=H.className.replace(/\bvf-no-js\b/,'vf-js')})(document.documentElement);
  </script>
  <meta charset="utf-8">
  <meta name="viewport" content=
  "width=device-width, initial-scale=1">
  <link rel="stylesheet" media="all" href="https://assets.emblstatic.net/vf/v2.4.5/css/styles.css">
  
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>
    
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
  
  
</head>

<body class="vf-body vf-stack"><script id="__bs_script__">//<![CDATA[
    document.write("<script async src='/browser-sync/browser-sync-client.js?v=2.26.14'><\/script>".replace("HOST", location.hostname));
//]]></script>

<section class="vf-intro" id="an-id-for-anchor">

  <div>
    <!-- empty -->
  </div>
  
  <div class="vf-stack">

<div class="vf-section-header"><a class="vf-section-header__heading vf-section-header__heading--is-link" href="JavaScript:Void(0);" id="section-link" onclick="myFunction('inputFile')">Input file <svg aria-hidden="true" class="vf-section-header__icon | vf-icon vf-icon-arrow--inline-end" width="1em" height="1em" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 12c0 6.627 5.373 12 12 12s12-5.373 12-12S18.627 0 12 0C5.376.008.008 5.376 0 12zm13.707-5.209l4.5 4.5a1 1 0 010 1.414l-4.5 4.5a1 1 0 01-1.414-1.414l2.366-2.367a.25.25 0 00-.177-.424H6a1 1 0 010-2h8.482a.25.25 0 00.177-.427l-2.366-2.368a1 1 0 011.414-1.414z" fill="" fill-rule="nonzero"></path>
    </svg></a></div>
    
<div id="inputFile" style="display:none">
  
    <p class="vf-intro__text">1) The xlsx file (Export Processed Data option) generated by the Nanotemper Prometheus instrument that has one sheet called 'Overview' with a column called 'Sample ID' (sample names), and four sheets called 'Ratio', '330nm', '350nm' and 'Scattering'. The first column of the signal sheet should be called 'Time [s]', the second column should have the temperature data and all subsequent columns the fluorescence data. The order of the columns containing the fluorescence signal should match the order of the 'Sample ID' column in the 'Overview' sheet <a href="demo.xlsx" download>(nDSFdemoFile.xlsx)</a>.</p>
    
    <p class="vf-intro__text">2) The xls file generated by the ThermoFluor Assay in a qPCR instrument. This file has one sheet called 'RFU' where the first row has the sample positions (header), the first column has the temperature data and all subsequent columns store the fluorescence data <a href="qPCRdemoFile.xls" download>(qPCRdemoFile.xls)</a>.</p>
    
    <p class="vf-intro__text">3) The xlsx file generated by the Nanotemper Prometheus Panta instrument. This file has one sheet called ‘Overview’ with a column called 'Sample ID' with the names of the samples, and one sheet called 'Data Export' (or 'melting-scan') where all the data is stored. <a href="panta.xlsx" download>(panta.xlsx)</a>.</p>
  
    <p class="vf-intro__text">4) The text file (.txt) generated by a QuantStudio™ 3 System instrument <a href="quantStudio.txt" download>(quantStudio.txt)</a>.</p>

    <p class="vf-intro__text">5) The xlsx file generated by the Nanotemper Prometheus Tycho instrument. This file has one sheet called ‘Results’ (with 6 columns named
    '#', 'Capillary label',..., 'Sample Brightness'), and one sheet called 'Profiles_raw' where the fluorescence data is stored <a href="tychoFile.xlsx" download>(tychoFile.xlsx)</a>.</p>

    <p class="vf-intro__text">6) The text file (.txt) generated by the Agilent's MX3005P qPCR instrument <a href="MX3005P.txt" download>(MX3005P.txt)</a>.</p>

    <p class="vf-intro__text">7) A csv file where the first column has the temperature data and all the subsequent columns the fluorescence data. Sample names are read from the header.</p>

    <p class="vf-intro__text">8) Send us your input file and we'll add a parser.</p>

</div>

<div class="vf-section-header"><a class="vf-section-header__heading vf-section-header__heading--is-link" href="JavaScript:Void(0);" id="section-link" onclick="myFunction('layoutFile')">Layout file <svg aria-hidden="true" class="vf-section-header__icon | vf-icon vf-icon-arrow--inline-end" width="1em" height="1em" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 12c0 6.627 5.373 12 12 12s12-5.373 12-12S18.627 0 12 0C5.376.008.008 5.376 0 12zm13.707-5.209l4.5 4.5a1 1 0 010 1.414l-4.5 4.5a1 1 0 01-1.414-1.414l2.366-2.367a.25.25 0 00-.177-.424H6a1 1 0 010-2h8.482a.25.25 0 00.177-.427l-2.366-2.368a1 1 0 011.414-1.414z" fill="" fill-rule="nonzero"></path>
    </svg></a></div>

<div id="layoutFile" style="display:none">
  
    <p class="vf-intro__text">Use a spreadsheet (.xls file) to complete the Condition versus Position Table. The first sheet should have a column called 'Well_No' and all of the following columns will be merged to create the condition name. To test this feature, download 
the file <a href="RUBIC Buffer Screen (MD1-96) screen conditions.xlsx" download>RUBIC Buffer Screen.xlsx</a> and use it together with the 'qPCRdemoFile.xls' file (Input file section).</p>

</div>

<div class="vf-section-header"><a class="vf-section-header__heading vf-section-header__heading--is-link" href="JavaScript:Void(0);" id="section-link" onclick="myFunction('models')">Models <svg aria-hidden="true" class="vf-section-header__icon | vf-icon vf-icon-arrow--inline-end" width="1em" height="1em" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 12c0 6.627 5.373 12 12 12s12-5.373 12-12S18.627 0 12 0C5.376.008.008 5.376 0 12zm13.707-5.209l4.5 4.5a1 1 0 010 1.414l-4.5 4.5a1 1 0 01-1.414-1.414l2.366-2.367a.25.25 0 00-.177-.424H6a1 1 0 010-2h8.482a.25.25 0 00.177-.427l-2.366-2.368a1 1 0 011.414-1.414z" fill="" fill-rule="nonzero"></path>
    </svg></a></div>
   
<div id="models" style="display:none"> 

<div class="vf-links">
  <ul class="vf-links__list | vf-list">
    <li class="vf-list__item">
      <a class="vf-list__link" onclick="myFunction('modelsEquilibriumTwoState')" href="JavaScript:Void(0);">
       Equilibrium Two State
      </a>
    </li>

  <div id="modelsEquilibriumTwoState" style="display:none">
  
    <p class="vf-intro__text">This model assumes that the protein exists in either native (N) or unfolded (U) state and that there is an equilibrium between the folding and unfolding reactions (N ⇆ U) <a href="https://pubs.acs.org/doi/10.1021/bi00421a014" class="vf-link">(Santoro, M.M. et al. , 1988)</a> <a href="https://www.sciencedirect.com/science/article/abs/pii/S0300908415003600
" class="vf-link">(Bedouelle, H., 2016)</a>. The law of signal F(T) is described by the equation</p>

$$
\large{ 
   \frac{k_nT+b_n+(k_uT+b_u)*exp(\frac{\Delta H_m}{R}(\frac{1}{T_m}-\frac{1}{T}))}{1 + exp(\frac{\Delta H_m}{R}(\frac{1}{T_m}-\frac{1}{T}))}
   }
$$

    <p class="vf-intro__text">where $k_n$, $b_n$ are the slope and intercept of the pre-transition (native) baseline, $k_u$, $b_u$ are the slope and intercept of post-transition (unfolded) baseline, $R$ is the universal gas constant, and $\Delta H_m$ is enthalpy of unfolding at melting temperature $T_m$. After fitting, $\Delta G$ of unfolding at 25°C (298.15 K) is estimated using </p>
    
    $$
\large{ 
   \Delta G_{298.15K} (\Delta H,T_m,C_p)=\Delta H (1-\frac{298.15K}{T_m})-C_p(C_pComponent)
   }
$$

    <p class="vf-intro__text">where </p>

    $$
\large{ 
C_pComponent(T_m)=T_m-298.15K + 298.15K*\log{(\frac{298.15K}{T_m})}
   }
$$
    
    <p class="vf-intro__text">Also, the fraction of unfolded protein at different temperatures is estimated using </p>

$$
\large{ 
FractionUnfolded(T_m,\Delta H, T) = \frac{exp(\frac{\Delta H}{R}(\frac{1}{T_m}-\frac{1}{T}))}{1+exp(\frac{\Delta H}{R}(\frac{1}{T_m}-\frac{1}{T}))}
}
$$    

    <p class="vf-intro__text">And the baseline separation factor by:
 </p>

$$
\large{
BS(k_u,b_u,T_m,k_n,b_n,stdErrorEstimate)=1-6 \frac{stdErrorEstimate}{|k_u T_m + b_u - (k_n T_m + b_n)|}
}
$$

</div>

    <li class="vf-list__item">
      <a class="vf-list__link" onclick="myFunction('modelsEmpiricalTwoState')" href="JavaScript:Void(0);">
      Empirical Two State
      </a>
    </li>

  <div id="modelsEmpiricalTwoState" style="display:none">
    
    <p class="vf-intro__text">This model is a descriptive version of the Equilibrium Two State model: instead of enthalpy of unfolding at $T_m$ ($\Delta H_m$), the model uses onset temperature $T_{onset}$ (temperature at which 1% of protein is unfolded) to describe the steepness of the curve <a href="https://www.nature.com/articles/s41598-019-46686-8" class="vf-link">(Kotov, V., et al., 2019)</a>. The law of signal F(T) is described by the equation
 </p>
 
$$
\large{
F(T)=\frac{k_n T + b_n + (k_u T + b_u)*exp(\frac{T-T_m*log(\frac{0.01}{0.99})}{T_{onset}-T_m})}{1+exp(\frac{T-T_m*log(\frac{0.01}{0.99})}{T_{onset}-T_m})}
}
$$

    <p class="vf-intro__text">To asses stability we provide a score which is the distance from the origin (0,0) to the point ($T_m$, $T_{onset}$). This score assumes that $T_m$ and $T_{onset}$ are equally important for protein stability. The baseline separation factor is estimated in the same way as in the 'Equilibrium Two State' model.
 </p>
</div>

    <li class="vf-list__item">
      <a class="vf-list__link" onclick="myFunction('modelsEquilibriumThreeState')" href="JavaScript:Void(0);">
      Equilibrium Three State
      </a>
    </li>

  <div id="modelsEquilibriumThreeState" style="display:none">
    
    <p class="vf-intro__text">This model assumes that the protein exists in three posible states: native (N), unfolded intermediate (I) and  unfolded (U) state <a href="https://www.nature.com/articles/s41598-017-16360-y" class="vf-link">(Mazurenko, S. et al., 2017)</a>. The law of signal F(T) is described by the equation
 </p>
 
$$

F(T)=\frac{k_n T + b_n+k_I *exp(\frac{\Delta H_{m1}}{R}(\frac{1}{T_1}-\frac{1}{T}))+(k_u T + b_u) *exp(\frac{\Delta H_{m1}}{R}(\frac{1}{T_1}-\frac{1}{T})) *exp(\frac{\Delta H_{m2}}{R}(\frac{1}{T_2}-\frac{1}{T})) }{1+exp(\frac{\Delta H_{m1}}{R}(\frac{1}{T_1}-\frac{1}{T})) *exp(\frac{\Delta H_{m2}}{R}(\frac{1}{T_2}-\frac{1}{T}))}

$$

    <p class="vf-intro__text">where $k_n$, $b_n$ are the slope and intercept of the pre-transition (native) baseline, $k_u$, $b_u$ are the slope and intercept of post-transition (unfolded) baseline, $k_I$ is the signal slope for the (short-lived) I state, $R$ is the universal gas constant, $\Delta H_{m1}$ and $\Delta H_{m2}$ are the enthalpy of unfolding at melting temperatures $T_1$ (N ⇆ I) and $T_2$ (I ⇆ U). 
 </p>
 
 
    <p class="vf-intro__text"> To asses stability we provide as score the free energy of unfolding extrapolated to 25°C, (sum of the free energy change for reactions N ⇆ I and I ⇆ U). 
 </p>
 
</div>

    <li class="vf-list__item">
      <a class="vf-list__link" onclick="myFunction('modelsEmpiricalThreeState')" href="JavaScript:Void(0);">
      Empirical Three State
      </a>
    </li>

  <div id="modelsEmpiricalThreeState" style="display:none">
    
    <p class="vf-intro__text">This model is a descriptive version of the Equilibrium Three State model where instead of enthalpy of unfolding we use $T_{onset1}$ and $T_{onset2}$. The law of signal F(T) is described by the equation
 </p>

$$

F(T)=\frac{k_n T +b_n+k_I*exp(\frac{(T-T_1)*log(\frac{0.01}{0.99})}{T_{onset1}-T_1})+(k_u T + b_u)*exp(\frac{(T-T_1)*log(\frac{0.01}{0.99})}{T_{onset1}-T_1})*exp(\frac{(T-T_2)*log(\frac{0.01}{0.99})}{T_{onset2}-T_2})}{1+exp(\frac{(T-T_1)*log(\frac{0.01}{0.99})}{T_{onset1}-T_1})*exp(\frac{(T-T_2)*log(\frac{0.01}{0.99})}{T_{onset2}-T_2})}

$$

    <p class="vf-intro__text">The provided score corresponds to the sum of the distance from the point (0,0) to ($T_{m1}$,$T_{onset1}$) and (0,0) to ($T_{m2}$,$T_{onset2}$).
 </p>

</div>

    <li class="vf-list__item">
      <a class="vf-list__link" onclick="myFunction('modelsIrreversibleTwoState')" href="JavaScript:Void(0);">
      Irreversible Two State
      </a>
    </li>

  <div id="modelsIrreversibleTwoState" style="display:none">

    <p class="vf-intro__text">This model assumes that the protein exists in two posible states: native (N) and  unfolded (U), and that the unfolding reaction is irreversible. The law of signal F(T) is described by the equation
 </p>

$$
\large{
F(T)=k_u T + b_u + (k_n T + b_n) * x_n(T)
}
$$

    <p class="vf-intro__text">where $k_n$, $b_n$ are the slope and intercept of the pre-transition (native) baseline, $k_u$, $b_u$ are the slope and the intercept of post-transition baseline, and $x_n(T)$ is the fraction of natively folded molecules as a function of temperature. $x_n(T)$ is obtained via numeric integration:
 </p>
 
$$
\large{
x_n(T)= \int_{T_{min}}^{T_{max}} \frac{-1}{v} exp(\frac{-Ea}{R}(\frac{1}{T}-\frac{1}{T_f}))x_n
}
$$
    <p class="vf-intro__text">where $T_{max}$ and $T_{min}$ are the start and end temperatures of the measurement, $v$ is the scan rate (degrees/min), $Ea$ is activation energy of unfolding, $T_f$ is the temperature where the reaction rate constant of unfolding (k) equals 1 and $R$ is the universal gas constant. $x_n$ is assumed to be 1 at $T_{min}$. Read <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1260351/" class="vf-link">(Sanchez-Ruiz J.M., 1992)</a> and <a href="https://www.nature.com/articles/s41598-017-16360-y" class="vf-link">(Mazurenko, S. et al., 2017)</a> for derivation of similar equations for differential scanning calorimetry data.
 </p>

    <p class="vf-intro__text">The final score for this model is the negative logarithm of the reaction rate constant at standard state temperature (pk_std). This metric integrates the slope and inflection point of the unfolding curve (represented here as $Ea$ and $T_f$) in a single measure of stability.
 </p>
 
</div>
</ul>
</div>
</div>

<div class="vf-section-header"><a class="vf-section-header__heading vf-section-header__heading--is-link" href="JavaScript:Void(0);" id="section-link" onclick="myFunction('Fitting')">Fitting <svg aria-hidden="true" class="vf-section-header__icon | vf-icon vf-icon-arrow--inline-end" width="1em" height="1em" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 12c0 6.627 5.373 12 12 12s12-5.373 12-12S18.627 0 12 0C5.376.008.008 5.376 0 12zm13.707-5.209l4.5 4.5a1 1 0 010 1.414l-4.5 4.5a1 1 0 01-1.414-1.414l2.366-2.367a.25.25 0 00-.177-.424H6a1 1 0 010-2h8.482a.25.25 0 00.177-.427l-2.366-2.368a1 1 0 011.414-1.414z" fill="" fill-rule="nonzero"></path>
    </svg></a></div>

<div id="Fitting" style="display:none">
  
    <p class="vf-intro__text">Each fluorescence curve is individually fitted using non-linear least squares with the scipy package curve_fit function. Is is important for the fitting routine to select a temperature range (in the '1. Load Input' step) that covers only the vicinity of the transition(s) that is(are) going to be analyzed.  To obtain initial estimates of $k_n$, $b_n$, $k_u$ and $b_u$ the first / last data of the each curve is fitted to a linear function. The initial estimates are also used to provide fitting boundaries as ± 40 % of the initial values. For the other parameters, the boundaries used for the fitting are described in the following Table.</p>

<p class="vf-intro__text"></p>

<table class="vf-table">

  <thead class="vf-table__header">
    <tr class="vf-table__row">
      <th class="vf-table__heading" scope="col"> Parameter
      </th>
      <th class="vf-table__heading" scope="col"> Lower bound
      </th>
      <th class="vf-table__heading" scope="col"> Upper bound
      </th>
    </tr>
  </thead>

  <tbody class="vf-table__body">
    
    <tr class="vf-table__row">
      <td class="vf-table__cell">$T_m$</td>
      <td class="vf-table__cell">Lowest temperature  + 6</td>
      <td class="vf-table__cell">Highest temperature - 6</td>
    </tr>
    
    <tr class="vf-table__row">
      <td class="vf-table__cell">$T_1$*</td>
      <td class="vf-table__cell">Lowest temperature  + 5</td>
      <td class="vf-table__cell">Middle temperature</td>
    </tr>
    
    <tr class="vf-table__row">
      <td class="vf-table__cell">$T_2$*</td>
      <td class="vf-table__cell">Middle temperature</td>
      <td class="vf-table__cell">Highest temperature  - 5</td>
    </tr>    
    
    <tr class="vf-table__row">
      <td class="vf-table__cell">$T_{onset}$</td>
      <td class="vf-table__cell">Lowest temperature  + 1</td>
      <td class="vf-table__cell">Highest temperature  - 11</td>
    </tr>

    <tr class="vf-table__row">
      <td class="vf-table__cell">$T_{onset1}$</td>
      <td class="vf-table__cell">$T_1$ lower bound - 5 degrees</td>
      <td class="vf-table__cell">$T_1$ higher bound - 5 degrees</td>
    </tr>
    
    <tr class="vf-table__row">
      <td class="vf-table__cell">$T_{onset2}$</td>
      <td class="vf-table__cell">$T_2$ lower bound - 5 degrees</td>
      <td class="vf-table__cell">$T_2$ higher bound - 5 degrees</td>
    </tr>

    <tr class="vf-table__row">
      <td class="vf-table__cell">$\Delta H_m$, $\Delta H_{m1}$, $\Delta H_{m2}$</td>
      <td class="vf-table__cell">2.5 kcal/mol</td>
      <td class="vf-table__cell">750 kcal/mol</td>
    </tr>

    <tr class="vf-table__row">
      <td class="vf-table__cell">$k_I$</td>
      <td class="vf-table__cell">1E-3</td>
      <td class="vf-table__cell">1E3</td>
    </tr>

  </tbody>
</table>

    <p class="vf-intro__text">*The boundaries of $T_1$ and $T_2$ can be changed by the user. The boundaries of $T_{onset1}$ and $T_{onset2}$ will be be modified accordingly.</p>

</div>


</div>
</section>

  <!-- IE11 polyfill JS -->
  <script nomodule crossorigin="anonymous" src="https://polyfill.io/v3/polyfill.min.js?flags=gated&features=default"></script>
  <script src="https://assets.emblstatic.net/vf/v2.4.5/scripts/scripts.js"></script>
  
  <!-- Hide div element onclick JS -->
  <script>
    function myFunction(divID) {
      var x = document.getElementById(divID);
      if (x.style.display === "none") {
        x.style.display = "block";
      } else {
        x.style.display = "none";
      }
    }
  </script>
  

  
</body>
</html>
