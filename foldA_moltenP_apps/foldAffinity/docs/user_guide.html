<!DOCTYPE html>
<html lang="en" class="vf-no-js" >
<head>
  <script>
  // Detect if JS is on and swap vf-no-js for vf-js on the html element
  (function(H){H.className=H.className.replace(/\bvf-no-js\b/,'vf-js')})(document.documentElement);
  </script>
  <meta charset="utf-8">
  <meta name="viewport" content=
  "width=device-width, initial-scale=1">
  <link rel="stylesheet" media="all" href="https://assets.emblstatic.net/vf/v2.4.5/css/styles.css">
  
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>
    
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
  
  
</head>

<body class="vf-body vf-stack"><script id="__bs_script__">//<![CDATA[
    document.write("<script async src='/browser-sync/browser-sync-client.js?v=2.26.14'><\/script>".replace("HOST", location.hostname));
//]]></script>


<section class="vf-intro" id="an-id-for-anchor">

  <div>
  
  <div class="vf-stack">

<div class="vf-section-header"><a class="vf-section-header__heading vf-section-header__heading--is-link" href="JavaScript:Void(0);" id="section-link" onclick="myFunction('beforeExperiment')">Before the experiment <svg aria-hidden="true" class="vf-section-header__icon | vf-icon vf-icon-arrow--inline-end" width="1em" height="1em" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 12c0 6.627 5.373 12 12 12s12-5.373 12-12S18.627 0 12 0C5.376.008.008 5.376 0 12zm13.707-5.209l4.5 4.5a1 1 0 010 1.414l-4.5 4.5a1 1 0 01-1.414-1.414l2.366-2.367a.25.25 0 00-.177-.424H6a1 1 0 010-2h8.482a.25.25 0 00.177-.427l-2.366-2.368a1 1 0 011.414-1.414z" fill="" fill-rule="nonzero"></path>
    </svg></a></div>
    
<div id="beforeExperiment" style="display:none">
  
    <p class="vf-intro__text">FoldAffinity allows the analysis of a fluorescence-based thermal shift assay where the protein concentration is constant and different ligand concentrations are used. The following Table can be used as a guideline before the experiment to have good estimates of the binding affinity (assuming protein concentration is around 10 μM).</p>

<p class="vf-intro__text"></p>

<table class="vf-table">

  <thead class="vf-table__header">
    <tr class="vf-table__row">
      <th class="vf-table__heading" scope="col"> Prior estimate of the dissociation constant (Kd)
      </th>
      <th class="vf-table__heading" scope="col"> Initial ligand concentration
      </th>
      <th class="vf-table__heading" scope="col"> Number of two-fold dilutions
      </th>
    </tr>
  </thead>

  <tbody class="vf-table__body">
    
    <tr class="vf-table__row">
      <td class="vf-table__cell">100-1000 μM</td>
      <td class="vf-table__cell">10 mM</td>
      <td class="vf-table__cell">11</td>
    </tr>
    
    <tr class="vf-table__row">
      <td class="vf-table__cell">1-100 μM</td>
      <td class="vf-table__cell">1000 μM</td>
      <td class="vf-table__cell">16</td>
    </tr>

    <tr class="vf-table__row">
      <td class="vf-table__cell">10-1000 nM</td>
      <td class="vf-table__cell">10 μM</td>
      <td class="vf-table__cell">16</td>
    </tr>

  </tbody>
</table>
    
</div>

<div class="vf-section-header"><a class="vf-section-header__heading vf-section-header__heading--is-link" href="JavaScript:Void(0);" id="section-link" onclick="myFunction('inputFile')">Input file <svg aria-hidden="true" class="vf-section-header__icon | vf-icon vf-icon-arrow--inline-end" width="1em" height="1em" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 12c0 6.627 5.373 12 12 12s12-5.373 12-12S18.627 0 12 0C5.376.008.008 5.376 0 12zm13.707-5.209l4.5 4.5a1 1 0 010 1.414l-4.5 4.5a1 1 0 01-1.414-1.414l2.366-2.367a.25.25 0 00-.177-.424H6a1 1 0 010-2h8.482a.25.25 0 00.177-.427l-2.366-2.368a1 1 0 011.414-1.414z" fill="" fill-rule="nonzero"></path>
    </svg></a></div>
    
<div id="inputFile" style="display:none">
  
    <p class="vf-intro__text">1) The xlsx file (Export Processed Data option) generated by the Nanotemper Prometheus machine that has one sheet called 'Overview' with a column called 'Sample ID' (sample names), and four sheets called 'Ratio', '330nm', '350nm' and 'Scattering'. The first column of the signal sheet should be called 'Time [s]', the second column should have the temperature data and all subsequent columns the fluorescence data. The order of the columns containing the fluorescence signal should match the order of the 'Sample ID' column in the 'Overview' sheet <a href="nDSFdemoFile.xlsx" download>(nDSFdemoFile.xlsx)</a>.</p>
    
    <p class="vf-intro__text">2) The xls file generated by the ThermoFluor Assay in a qPCR machine. This file has one sheet called 'RFU' where the first row has the sample positions (header), the first column has the temperature data and all subsequent columns store the fluorescence data <a href="qPCRdemoFile.xls" download>(qPCRdemoFile.xls)</a>.</p>
  
    <p class="vf-intro__text">3) The xlsx file generated by the Nanotemper Prometheus Panta instrument. This file has one sheet called ‘Overview’ with a column called 'Sample ID' with the names of the samples, and one sheet called 'Data Export' (or 'melting-scan') where all the data is stored. <a href="panta.xlsx" download>(panta.xlsx)</a>.</p>
  
    <p class="vf-intro__text">4) The text file (.txt) generated by a QuantStudio™ 3 System instrument <a href="quantStudio.txt" download>(quantStudio.txt)</a>.</p>

    <p class="vf-intro__text">5) The xlsx file generated by the Nanotemper Prometheus Tycho instrument. This file has one sheet called ‘Results’ (with 6 columns named
    '#', 'Capillary label',..., 'Sample Brightness'), and one sheet called 'Profiles_raw' where the fluorescence data is stored <a href="tychoFile.xlsx" download>(tychoFile.xlsx)</a>.</p>

    <p class="vf-intro__text">6) The text file (.txt) generated by the Agilent's MX3005P qPCR instrument <a href="MX3005P.txt" download>(MX3005P.txt)</a>.</p>

    <p class="vf-intro__text">7) A csv file where the first column has the temperature data and all the subsequent columns the fluorescence data. Sample names are read from the header.</p>

    <p class="vf-intro__text">8) The json file that can be directly exported from
    FoldAffinity. This file contains also the analysis results.</p>

    <p class="vf-intro__text">9) Send us your input file and we'll add a parser.</p>

</div>

<!--This is a comment. Comments are not displayed in the browser

<div class="vf-section-header"><a class="vf-section-header__heading vf-section-header__heading--is-link" href="JavaScript:Void(0);" id="section-link" onclick="myFunction('signalToAnalyse')">Signal to analyse <svg aria-hidden="true" class="vf-section-header__icon | vf-icon vf-icon-arrow--inline-end" width="1em" height="1em" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 12c0 6.627 5.373 12 12 12s12-5.373 12-12S18.627 0 12 0C5.376.008.008 5.376 0 12zm13.707-5.209l4.5 4.5a1 1 0 010 1.414l-4.5 4.5a1 1 0 01-1.414-1.414l2.366-2.367a.25.25 0 00-.177-.424H6a1 1 0 010-2h8.482a.25.25 0 00.177-.427l-2.366-2.368a1 1 0 011.414-1.414z" fill="" fill-rule="nonzero"></path>
    </svg></a></div>

<div id="signalToAnalyse" style="display:none">
  
    <p class="vf-intro__text">If you performed a DSF experiment where the
    reported signal corresponds to the intrinsic fluorescence of the protein, try to perform the analysis using the 350 nm or 330 nm wavelength. If the transition is not clear enough and can't be correctly fitted, then you can use the Ratio signal (F350/F330) only if the following equation holds true (inside the selected temperature range of analysis):</p>
  
$$
\large{ 
    0.67 \leq\frac{S_{D330}}{S_{N330}} \leq 1.5
   }
$$
    
  <p class="vf-intro__text">where \( S_{N330} \) and \( S_{D330} \) are the value of the fluorescence signal measured at 330 nm before and after the denaturation process, respectively. </p>    
    
</div>

-->

<div class="vf-section-header"><a class="vf-section-header__heading vf-section-header__heading--is-link" href="JavaScript:Void(0);" id="section-link" onclick="myFunction('models')">Models <svg aria-hidden="true" class="vf-section-header__icon | vf-icon vf-icon-arrow--inline-end" width="1em" height="1em" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 12c0 6.627 5.373 12 12 12s12-5.373 12-12S18.627 0 12 0C5.376.008.008 5.376 0 12zm13.707-5.209l4.5 4.5a1 1 0 010 1.414l-4.5 4.5a1 1 0 01-1.414-1.414l2.366-2.367a.25.25 0 00-.177-.424H6a1 1 0 010-2h8.482a.25.25 0 00.177-.427l-2.366-2.368a1 1 0 011.414-1.414z" fill="" fill-rule="nonzero"></path>
    </svg></a></div>
   
<div id="models" style="display:none"> 

 <p class="vf-intro__text"> The models implemented in FoldAffinity are based on the coupling between ligand binding and protein folding and require that the ligand is completely soluble. If you have done a nDSF experiment, you can assume that the ligand is soluble if the turbidity (scattering signal) is the same at all concentrations.</p>
 <br>

<div class="vf-links">
  <ul class="vf-links__list | vf-list">
    <li class="vf-list__item">
      <a class="vf-list__link" onclick="myFunction('modelsFluorescenceSignal')" href="JavaScript:Void(0);">
       Fluorescence signal
      </a>
    </li>

  <div id="modelsFluorescenceSignal" style="display:none">
  
    <p class="vf-intro__text">Fluorescence melting curves are fitted using a simple two-state folding model where the signal corresponds to a linear combination of the amount of folded and unfolded protein and the fluorescence dependence on temperature is described by a linear function.</p>

$$
\large{ 
    Fluorescence(T) = F*(IF + T*SF) + U*(IU + T*SU)
   }
$$

    <p class="vf-intro__text">where F and U are respectively the folded and unfolded fractions. IF, IU are respectively the intercept of the folded and unfolded states. SF, SU are respectively the slope of the folded and unfolded states. T is the temperature and </p>
    
    $$
\large{ 
     F = \frac{F}{1+ K_{u,Obs}} 
   }
$$

    $$
\large{ 
    U = \frac{K_{u,Obs}}{1+ K_{u,Obs}} 
   }
$$
    <p class="vf-intro__text">with</p>

    $$
\large{ 
K_{u,Obs} = exp(\frac{- \Delta G_{u,Obs}}{RT})
   }
$$
    
    $$
\large{ 
\Delta G_{u,Obs} = \Delta H_{u,Obs} (1 - \frac{T}{T_{m,Obs}+273.15}) - \\ Cp*(T_{m,Obs}+273.15 - T + T *log(\frac{T}{T_{m,Obs}+273.15}))
   }
$$
    
    <p class="vf-intro__text">where R is the gas constant.</p>

 <p class="vf-intro__text">FoldAffinity provides three different ways of fitting the fluorescence melting curves. Local:  Each fluorescence curve is individually fitted. The value of Cp is selected by the user. Global: Each fluorescence curve is first individually fitted. Then, a global fit is performed where the slope values (SF and SU) are constrained to be the same in all curves. The value of Cp is selected by the user. Global_CP: Same as global, but this time Cp is included as a parameter to be fitted.</p>

</div>

    <li class="vf-list__item">
      <a class="vf-list__link" onclick="myFunction('modelsFractionunfolded')" href="JavaScript:Void(0);">
      Unfolded fraction 
      </a>
    </li>

  <div id="modelsFractionunfolded" style="display:none">
    
    <p class="vf-intro__text">Once the fluorescence curves are fitted, it is possible to use the observed unfolding constant \( K_{u,Obs} \) to obtain the unfolded fraction at different ligand concentrations and perform isothermal binding analysis. At a fixed temperature, the system can be described by the following reactions:</p>
 
$$
\large{
U +  L  \rightleftharpoons F + L  \rightleftharpoons FL
}
$$

  <p class="vf-intro__text"> with equations</p>
 
$$
\large{
K_u = \frac{U}{F} 
}
$$

$$
\large{
K_d = \frac{F*L}{FL}
} 
$$

$$
\large{
P_0 = U+F+FL 
}
$$

$$
\large{
 L_0 = L+FL   
}
$$

  <p class="vf-intro__text"> where \( {K}_u \) is the unfolding constant, \(  {K}_d \) is the dissociation constant, \(  {P}_0 \) is the total protein concentration, and \(  {L}_0 \) is the total ligand concentration. If we know \(  {K}_u \) and \(  {K}_d \) we can get FL by solving
</p>

$$
\large{
     0 = FL^2 - FL * (P_0+L_0+{K}_d(1+{K}_u)) + P_0*L_0
}
$$

    <p class="vf-intro__text">And then, U and F can be easily calculated in order to determine the unfolded fraction  ( \(  \frac{U}{U+F+FL} \) ). Therefore, the isothermal fitting consists of fitting \(  {K}_d \) and \(  {K}_u \) to minimize the difference between the measured unfolded fraction  (derived from \(  {K}_{u,Obs} \)) and the one predicted by solving the chemical equilibriums.</p>
  
  <p class="vf-intro__text">In case of the two sites model, the system is described by the reactions</p>  
    
$$
\large{
U +  2L  \rightleftharpoons F + 2L
}
$$

$$
\large{
F +  2L  \rightleftharpoons FL + L
}
$$

$$
\large{
F +  2L  \rightleftharpoons LF + L
}
$$

$$
\large{
FL +  L  \rightleftharpoons LFL 
}
$$

$$
\large{
LF +  L  \rightleftharpoons LFL
}
$$
 
     <p class="vf-intro__text">and we have to solve </p>  

$$
\large{
Fraction of Unfolded Protein = \frac{K_u*F}{K_u*F+F+FL+LF+LFL}
}
$$
 
     <p class="vf-intro__text"> where F is the free folded protein, FL and LF are the two possible protein-ligand complexes and LFL is the protein with two ligands. F, FL, LF and LFL depend on the Kds, total ligand and free ligand concentration \(L_{free}\) in the following way:
</p>  

$$
\large{
F = (\frac{K_{d1} * K_{d2}*(L_0 - L_{free})}{K_{d1}+K_{d2}+2L_{free}}) / L_{free}
}
$$

$$
\large{
    FL  = \frac{L_{free}*F}{K_{d2}}  
}
$$

$$
\large{
    LF  = \frac{L_{free}*F}{K_{d1}}  
}
$$

$$
\large{
    LFL = \frac{L_{free}*LF}{K_{d2}}   
}
$$
 
      <p class="vf-intro__text">We can obtain the value of \(L_{free}\) by solving the cubic equation</p>  
 
 $$
\large{
       X^3 + pX^2 + qX + r = 0

}
$$

$$
\large{
       p = [ K_{d1} + K_{d2} + (2*P_0 - L_0) ] 

}
$$

$$
\large{
      q = [ (P_0 - L_0) * (K_{d1}+K_{d2}) + K_{d1}*Kd2 * (1+K_u) ] 
}
$$

$$
\large{
    r = [ -L_0*K_{d1}*K_{d2} * (1+K_u) ] 
}
$$

      <p class="vf-intro__text">For simplicity, in the current version of FoldAffinity we provide only the model where \(K_{d1} = K_{d2}\).
</p>  

</div>

    <li class="vf-list__item">
      <a class="vf-list__link" onclick="myFunction('modelsTmShiftFitting')" href="JavaScript:Void(0);">
      Alternative model: Tm shift fitting
      </a>
    </li>

  <div id="modelsTmShiftFitting" style="display:none">
    
        <p class="vf-intro__text">The following models are based on the work presented in <a href="https://onlinelibrary.wiley.com/doi/epdf/10.1002/bip.1975.360140509" target="_blank">Schellman, 1975</a></p>
    
    <p class="vf-intro__text">Given that for all ligand concentrations at the observed melting temperature,</p>
 
$$
\large{
\Delta G (T_{m,Obs}) = \Delta H - T_{m,Obs} * \Delta S + R T_{m,Obs} * ln(1+\frac{L_{free}}{K_d}) = 0
}
$$
  
  <p class="vf-intro__text">or in case of two binding sites,</p>

$$
\large{
\Delta G (T_{m,Obs}) = \Delta H - T_{m,Obs} * \Delta S + R T_{m,Obs} * 
ln(1+\frac{L_{free}*(L_{free}+K_{d1}+K_{d2})}{K_{d1}*K_{d2}} ) = 0
}
$$

  <p class="vf-intro__text">and at the melting temperature of the protein </p>

$$
\large{
    T_m    =   \frac{ \Delta H }{ \Delta S } 
}
$$

  <p class="vf-intro__text">If we assume that \(\Delta H\) and \(\Delta S\) do not change much between \(Tm\) and \(T_{m,Obs}\), and that the total ligand concentration equals the free ligand concentration we can use both equations to get \(T_{m,Obs}\) as a function of the (total) ligand concentration.</p>


$$
\large{
   T_{m,Obs} = T_m / (1 - \frac{RT_m*ln ( 1+\frac{L_{free}}{K_d})}{\Delta H})
}
$$

$$
\large{
        T_{m,Obs} = T_m / (1 - \frac{RT_m*ln (1+\frac{L_{free}*(L_{free}+K_{d1}+K_{d2})}{K_{d1}*K_{d2}}  ) }{\Delta H} )
}
$$

  <p class="vf-intro__text">
In this model, \(T_m\) and \(T_{m,Obs}\) are determined using the maximum (or minimum) of the first derivative. \(T_{m,Obs}\) is obtained for each ligand concentration and \(T_m\) is estimated from the capillary/well with the lowest ligand concentration.For this model to work, it is important that the free ligand concentration can be approximated by total ligand concentration,  and not necessarily in all positions, but most importantly were the signal changes significantly.</p>

</div>

</ul>
</div>
</div>

<div class="vf-section-header"><a class="vf-section-header__heading vf-section-header__heading--is-link" href="JavaScript:Void(0);" id="section-link" onclick="myFunction('FittingErros')">Fitting errors and confidence intervals <svg aria-hidden="true" class="vf-section-header__icon | vf-icon vf-icon-arrow--inline-end" width="1em" height="1em" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 12c0 6.627 5.373 12 12 12s12-5.373 12-12S18.627 0 12 0C5.376.008.008 5.376 0 12zm13.707-5.209l4.5 4.5a1 1 0 010 1.414l-4.5 4.5a1 1 0 01-1.414-1.414l2.366-2.367a.25.25 0 00-.177-.424H6a1 1 0 010-2h8.482a.25.25 0 00.177-.427l-2.366-2.368a1 1 0 011.414-1.414z" fill="" fill-rule="nonzero"></path>
    </svg></a></div>

<div id="FittingErros" style="display:none">
  
    <p class="vf-intro__text"> When fitting the thermal unfolding curves, we calculate the error of the fitted parameters based on the square root of the diagonal values from the fit parameter covariance matrix (2. Fit fluorescence).</p>
    
    <p class="vf-intro__text"> When fitting the isotherms (Unfolded Fraction versus ligand concentration, 3. Fit unfolded fraction), or applying the model based on the thermal shift (Tm fitting), we provide the marginal asymmetric confidence interval (Vaida Paketuryte, et al, 2021). </p>

</div>

<div class="vf-section-header"><a class="vf-section-header__heading vf-section-header__heading--is-link" href="JavaScript:Void(0);" id="section-link" onclick="myFunction('Limitations')">Limitations <svg aria-hidden="true" class="vf-section-header__icon | vf-icon vf-icon-arrow--inline-end" width="1em" height="1em" xmlns="http://www.w3.org/2000/svg">
      <path d="M0 12c0 6.627 5.373 12 12 12s12-5.373 12-12S18.627 0 12 0C5.376.008.008 5.376 0 12zm13.707-5.209l4.5 4.5a1 1 0 010 1.414l-4.5 4.5a1 1 0 01-1.414-1.414l2.366-2.367a.25.25 0 00-.177-.424H6a1 1 0 010-2h8.482a.25.25 0 00.177-.427l-2.366-2.368a1 1 0 011.414-1.414z" fill="" fill-rule="nonzero"></path>
    </svg></a></div>

<div id="Limitations" style="display:none">
  
    <p class="vf-intro__text">The main limitation of the isothermal approach implemented in FoldAffinity is that the underlying data generating process does not match with the equations used in the fluorescence fitting. In fact, \(K_{u,Obs}\) ( \(  \frac{U}{F+FL} \) in the case of one binding site) fitted from the fluorescence signal corresponds to</p>
    
$$
\large{
       \Delta G_{Obs}  (T) = \Delta H_{Obs} * (1 - \frac{T}{T_{m,Obs}+273.15}) - \\ Cp * (T_{m,Obs}+273.15 - T + T * log(\frac{T}{T_{m,Obs}+273.15 }) )
}
$$
    
<p class="vf-intro__text">but \( \Delta G_{Obs} \) is (in the case of one binding site and reversible folding)</p>

$$
\large{
\Delta G_{Obs} (T) = \Delta G_{unfolding} + \Delta G_{binding} = -RT * ln(K_u) + RT * ln(1+\frac{L_{free}}{K_d})
}
$$

<p class="vf-intro__text">where \( L_{free} \) is the free ligand concentration and \( K_u \) is the chemical constant \( \frac{U}{F} \). In FoldAffinity, we fit only the left side of the equation, therefore we can notice that the less ligand concentration we have, \( K_{u,Obs} \) approximates \( K_u \), the fitted enthalpy corresponds to the 'true' enthalpy of unfolding and \( T_{m,Obs} \) corresponds to the 'true' \( T_m \) (where F = U). Although this approach may seem counterintuitive at first, we have shown that the equations used in this work can be used to correctly estimate the binding affinity of simulated data. And what is most important, we have shown that they are in good agreement with experimental data obtained by already established methods like Microscale Thermophoresis (MST) and Isothermal Titration Calorimetry (ITC).</p>

</div>

</div>
</div>
</section>

  <!-- IE11 polyfill JS -->
  <script nomodule crossorigin="anonymous" src="https://polyfill.io/v3/polyfill.min.js?flags=gated&features=default"></script>
  <script src="https://assets.emblstatic.net/vf/v2.4.5/scripts/scripts.js"></script>
  
  <!-- Hide div element onclick JS -->
  <script>
    function myFunction(divID) {
      var x = document.getElementById(divID);
      if (x.style.display === "none") {
        x.style.display = "block";
      } else {
        x.style.display = "none";
      }
    }
  </script>
  

</body>
</html>
